<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Note Share - Home</title>
<style>

    body { font-family: sans-serif; padding: 20px; }

    input, button { padding: 10px; font-size: 1rem; }
</style>
</head>
<body>
<h1>ğŸ“ Note Share</h1>
<button onclick="createNote()">+ New Note</button>
<div id="notes"></div>
<script>

    async function createNote() {

      const id = Math.random().toString(36).substring(2, 8);

      await saveNote(id, "");

      location.href = `note.html?id=${id}`;

    }

    async function saveNote(id, content) {

      const db = await openDB();

      db.put("notes", { id, content });

    }

    async function openDB() {

      return await idb.openDB("noteDB", 1, {

        upgrade(db) {

          db.createObjectStore("notes", { keyPath: "id" });

        },

      });

    }

    async function listNotes() {

      const db = await openDB();

      const tx = db.transaction("notes", "readonly");

      const store = tx.objectStore("notes");

      const all = await store.getAll();

      const container = document.getElementById("notes");

      all.forEach(n => {

        const a = document.createElement("a");

        a.href = `note.html?id=${n.id}`;

        a.textContent = `ğŸ—’ï¸ ${n.id}`;

        a.style.display = "block";

        container.appendChild(a);

      });

    }

    window.onload = () => {

      listNotes();

    };
</script>
<script src="https://unpkg.com/idb/build/iife/index-min.js"></script>
</body>
</html>
 
